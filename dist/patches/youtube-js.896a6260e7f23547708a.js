"use strict";(self.webpackChunkCmlsPlayer=self.webpackChunkCmlsPlayer||[]).push([[521],{3283:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});n(8858),n(1318),n(3228),n(560);var o=n(5826),a=n(54),r=n(3583),u=n(3537),i=n(300);const s=["youtube.com","youtu.be","youtube-nocookie.com"],c="data-cmlsp-patched";let d=!1;window.onYouTubeIframeAPIReady&&(window._onYouTubeIframeAPIReady=window.onYouTubeIframeAPIReady),window.onYouTubeIframeAPIReady=()=>{window._onYouTubeIframeAPIReady&&window._onYouTubeIframeAPIReady(),d=!0};const w=new r.Z("Patches / YouTube");function l(){return document.querySelectorAll(s.map((e=>`iframe[src*="${e}"]:not([${c}])`)).join(","))}const f=[],m=e=>{f.forEach((e=>{if(e?.getPlayerState){const t=e.getPlayerState();t>0&&2!==t&&(w.debug("Pausing YT video",e?.g),e.pauseVideo())}}))};function b(){const e=l();e.length&&(document.querySelector('script[src*="https://www.youtube.com/iframe_api"]')||document.head.append((0,o.h)("script",{async:!0,src:"https://www.youtube.com/iframe_api"})),e.forEach((e=>{const t=new URL(e.getAttribute("src"));"1"!==t.searchParams.get("enablejsapi")&&(t.searchParams.set("enablejsapi",1),e.setAttribute("src",t));const n=e.getAttribute("id");n&&n.length||e.setAttribute("id",(0,i.Z)())})),(0,u.Z)(null,(()=>{if(void 0!==window.YT?.Player&&!0===d)return!0})).then((()=>{l().forEach((e=>{if(!e.getAttribute(c)){const t=e.getAttribute("id"),n=new window.YT.Player(t,{events:{onStateChange:e=>{e.data===window.YT.PlayerState.PLAYING&&a.B.stop()}}});e.setAttribute(c,!0),f.push(n),w.debug("Assigned listener",n)}}))})).catch((e=>w.debug("YT SDK failed",e))))}window.addEventListener("cmls-player-preroll-start",m),window.addEventListener("cmls-player-stream-start",m)},3537:function(e,t,n){function o(e,t=(e=>void 0!==e),n=1e4){const o=Date.now();return new Promise((function a(r,u){t(e)?r(e):Date.now()-o>=n?u(new Error("Timed out waiting for ref")):setTimeout(a.bind(this,r,u),50)}))}n.d(t,{Z:function(){return o}})}}]);