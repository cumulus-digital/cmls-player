"use strict";(self.webpackChunkCmlsPlayer=self.webpackChunkCmlsPlayer||[]).push([[521],{3283:function(e,t,n){n.r(t),n.d(t,{default:function(){return f}});n(8858),n(1318),n(3228),n(560);var o=n(5826),r=n(54),a=n(3583),u=n(3537),i=n(300);const s=["youtube.com","youtu.be","youtube-nocookie.com"];let c=!1;window.onYouTubeIframeAPIReady&&(window._onYouTubeIframeAPIReady=window.onYouTubeIframeAPIReady),window.onYouTubeIframeAPIReady=()=>{window._onYouTubeIframeAPIReady&&window._onYouTubeIframeAPIReady(),c=!0};const d=new a.Z("Patches / YouTube");function w(){return document.querySelectorAll(s.map((e=>`iframe[src*="${e}"]:not([cmls-patched])`)).join(","))}const l=[],m=e=>{l.forEach((e=>{e?.pauseVideo&&(d.debug("Pausing YT video",e?.g),e.pauseVideo())}))};function f(){const e=w();e.length&&(document.querySelector('script[src*="https://www.youtube.com/iframe_api"]')||document.head.append((0,o.h)("script",{async:!0,src:"https://www.youtube.com/iframe_api"})),e.forEach((e=>{const t=new URL(e.getAttribute("src"));"1"!==t.searchParams.get("enablejsapi")&&(t.searchParams.set("enablejsapi",1),e.setAttribute("src",t));const n=e.getAttribute("id");n&&n.length||e.setAttribute("id",(0,i.Z)())})),(0,u.Z)(null,(()=>{if(void 0!==window.YT?.Player&&!0===c)return!0})).then((()=>{w().forEach((e=>{if(!e.getAttribute("cmls-patched")){const t=e.getAttribute("id"),n=new window.YT.Player(t,{events:{onStateChange:e=>{e.data===window.YT.PlayerState.PLAYING&&r.B.stop()}}});e.setAttribute("cmls-patched",!0),l.push(n),d.debug("Assigned listener",n)}}))})).catch((e=>d.debug("YT SDK failed",e))))}window.addEventListener("cmls-player-preroll-start",m),window.addEventListener("cmls-player-stream-start",m)},3537:function(e,t,n){function o(e,t=(e=>void 0!==e),n=1e4){const o=Date.now();return new Promise((function r(a,u){t(e)?a(e):Date.now()-o>=n?u(new Error("Timed out waiting for ref")):setTimeout(r.bind(this,a,u),50)}))}n.d(t,{Z:function(){return o}})}}]);