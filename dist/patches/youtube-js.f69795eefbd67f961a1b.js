"use strict";(self.webpackChunkCmlsPlayer=self.webpackChunkCmlsPlayer||[]).push([[521],{3283:function(e,t,n){n.r(t),n.d(t,{default:function(){return m}});n(8858),n(1318),n(3228),n(560);var o=n(5826),r=n(54),a=n(3583),u=n(3537);n(300);const i=["youtube.com","youtu.be","youtube-nocookie.com"];let s=!1;window.onYouTubeIframeAPIReady&&(window._onYouTubeIframeAPIReady=window.onYouTubeIframeAPIReady),window.onYouTubeIframeAPIReady=()=>{window._onYouTubeIframeAPIReady&&window._onYouTubeIframeAPIReady(),s=!0};const c=new a.Z("Patches / YouTube");function d(){return document.querySelectorAll(i.map((e=>`iframe[src*="${e}"]:not([cmls-patched])`)).join(","))}const w=[];function l(e){w.forEach((e=>{c.debug("Pausing video",e),e?.pauseVideo()}))}function m(){const e=d();e.length&&(document.querySelector('script[src*="https://www.youtube.com/iframe_api"]')||document.head.append((0,o.h)("script",{async:!0,src:"https://www.youtube.com/iframe_api"})),e.forEach((e=>{const t=new URL(e.getAttribute("src"));"1"!==t.searchParams.get("enablejsapi")&&(t.searchParams.set("enablejsapi",1),e.setAttribute("src",t))})),(0,u.Z)(null,(()=>{if(void 0!==window.YT?.Player&&!0===s)return!0})).then((()=>{d().forEach((e=>{if(!e.getAttribute("cmls-patched")){e.getAttribute("id");const t=new window.YT.Player(e);t.addEventListener("onStateChange",(e=>{e.data===window.YT.PlayerState.PLAYING&&r.B.stop()})),window.addEventListener("cmls-player-preroll-start",(()=>t.pauseVideo())),e.setAttribute("cmls-patched",!0),w.push(t),c.debug("Assigned listener",e)}}))})).catch((()=>c.debug("YT SDK failed"))))}window.addEventListener("cmls-player-preroll-start",l),window.addEventListener("cmls-player-stream-start",l)},3537:function(e,t,n){function o(e,t=(e=>void 0!==e),n=1e4){const o=Date.now();return new Promise((function r(a,u){t(e)?a(e):Date.now()-o>=n?u(new Error("Timed out waiting for ref")):setTimeout(r.bind(this,a,u),50)}))}n.d(t,{Z:function(){return o}})}}]);